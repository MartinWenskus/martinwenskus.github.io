(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{d151:function(e,t,n){"use strict";n.r(t);var o,i,a=n("967e"),s=n.n(a),u=(n("7f7f"),n("c47a")),l=n.n(u),p=(n("96cf"),n("fa84")),r=n.n(p),c=(n("28a5"),n("551c"),n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("8993")),d=n.n(c),f=n("3a82"),h={name:"FBQUploader",mixins:[f["a"]],props:{meta:{type:Object},prefixPath:{type:String}},computed:{isUploading:function(){return this.uploading},isBusy:function(){return this.uploading}},data:function(){return{uploading:!1,filesUploading:[]}},methods:{abort:function(){this.uploading=!1},updateComponent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uploading",o=this.files[e],i="object"===d()(t)?t.bytesTransferred:0;this.__updateFile(o,n,i)},upload:function(){var e=this;!1!==this.canUpload&&(this.uploading=!0,this.queuedFiles.forEach((function(t){e.filesUploading.push(e.uploadFileToFirestore(t))})),Promise.all(this.filesUploading).then((function(){e.uploading=!1})).catch((function(t){e.$q.notify({color:"negative",message:"One or more of your files failed to upload. ".concat(t)})})))},uploadFileToFirestore:function(e){var t=this,n=this.meta,o=this.$fb,i=o.userRef,a=o.storageRef,u=this.filesUploading.length,p=e.type.split("/")[1],c=a("".concat(this.prefixPath).concat(p)),d=c.put(e),f=this.$fb.self().storage.TaskEvent.STATE_CHANGED;return new Promise((function(e,o){d.on(f,(function(e){t.updateComponent(u,e)}),(function(e){t.$q.notify({color:"negative",message:"There was a problem with the upload. ".concat(e)}),t.updateComponent(u,0,"failed"),o()}),(function(){t.uploadedFiles=t.uploadedFiles.concat(t.files),t.queuedFiles=[],t.filesUploading=[],t.files.forEach(function(){var e=r()(s.a.mark((function e(o){var a;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateComponent(u,0,"uploaded"),e.next=3,d.snapshot.ref.getDownloadURL();case 3:a=e.sent,i("users",n.id).update(l()({},"".concat(n.photoType,"Photo"),a)),t.$emit("uploaded",{files:[o.name]});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e()}))}))}}},g=h,m=n("2877"),w=Object(m["a"])(g,o,i,!1,null,null,null);t["default"]=w.exports}}]);